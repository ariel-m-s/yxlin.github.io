<!DOCTYPE html>

<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Begin Jekyll SEO tag v2.4.0 -->
<title>Three-accumulator LBA Model | Cognitive Models</title>
<meta name="generator" content="Jekyll v3.7.2" />
<meta property="og:title" content="Three-accumulator LBA Model" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="We have striven to minimize the number of errors. However, we canot guarantee the note is 100% accurate." />
<meta property="og:description" content="We have striven to minimize the number of errors. However, we canot guarantee the note is 100% accurate." />
<link rel="canonical" href="http://localhost:4000/cognitive-model/lba3/" />
<meta property="og:url" content="http://localhost:4000/cognitive-model/lba3/" />
<meta property="og:site_name" content="Cognitive Models" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-04T13:40:30+00:00" />
<script type="application/ld+json">
{"datePublished":"2019-10-04T13:40:30+00:00","description":"We have striven to minimize the number of errors. However, we canot guarantee the note is 100% accurate.","@type":"Article","url":"http://localhost:4000/cognitive-model/lba3/","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/siteicon.png"}},"headline":"Three-accumulator LBA Model","dateModified":"2019-10-04T13:40:30+00:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

		<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Cognitive Models" />

		<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic|Open+Sans:400,400italic,600,600italic,700,700italic|Inconsolata:400,700">
		<link rel="stylesheet" href="/css/main.css">
		<link rel="apple-touch-icon" href="/apple-touch-icon.png">
		<link rel="icon" type="image/png" href="/touch-icon.png" sizes="192x192">
		<link rel="icon" type="image/png" href="/images/favicon.png">

		
	</head>

	<body>
	  <header>
	    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script>
	    
			<h1>
				<a href="/"><img src="/images/emblem.svg" width="40" height="40" alt="Cognitive Models logo"></a>
				Cognitive Models
				<button type="button" class="open-nav" id="open-nav"></button>
			</h1>

			<form action="/search/" method="get">
				<input type="text" name="q" id="search-input" placeholder="Search" autofocus>
				<input type="submit" value="Search" style="display: none;">
			</form>

			<nav >
				<ul>
					<li class="nav-item top-level ">
						
						<a href="/"></a>
					</li>
				</ul>

				<ul>
					
					
						<li class="nav-item top-level ">
							
							<a href="/BUGS/hnormal/">BUGS Examples Volumn 1</a>
							<ul>
								
									<li class="nav-item "><a href="/BUGS/hnormal/">Hierarchical Normal Model</a></li>
								
									<li class="nav-item "><a href="/BUGS/seeds/">Random effect logistic regression</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/approximation/kde/">Likelihood Free Method</a>
							<ul>
								
									<li class="nav-item "><a href="/approximation/kde/">Kernel Density Estimation</a></li>
								
									<li class="nav-item "><a href="/approximation/pda/">Probability Density Approximation</a></li>
								
									<li class="nav-item "><a href="/approximation/ppda/">Parallel Probability Density Approximation</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/basics/model_array/">Modelling Basics</a>
							<ul>
								
									<li class="nav-item "><a href="/basics/model_array/">Model Array</a></li>
								
									<li class="nav-item "><a href="/basics/simulation/">Simulation</a></li>
								
									<li class="nav-item "><a href="/basics/descriptive/">Descriptive Statistics</a></li>
								
									<li class="nav-item "><a href="/basics/summary/">Summary Statistics</a></li>
								
									<li class="nav-item "><a href="/basics/mle/">Maximising Likelihoods</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/bayes-basics/theorem/">Bayesian Basics</a>
							<ul>
								
									<li class="nav-item "><a href="/bayes-basics/theorem/">Bayes' Theorem</a></li>
								
									<li class="nav-item "><a href="/bayes-basics/prior/">Prior Distribution</a></li>
								
									<li class="nav-item "><a href="/bayes-basics/likelihood/">Model Likelihood</a></li>
								
									<li class="nav-item "><a href="/bayes-basics/posterior/">Posterior Distribution</a></li>
								
									<li class="nav-item "><a href="/bayes-basics/diagnosis/">Checking Fitted Models</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level current">
							
							<a href="/cognitive-model/lba/">Cognitive Model</a>
							<ul>
								
									<li class="nav-item "><a href="/cognitive-model/lba/">LBA Model</a></li>
								
									<li class="nav-item "><a href="/cognitive-model/pm/">PM Model</a></li>
								
									<li class="nav-item "><a href="/cognitive-model/plba/">PLBA Model</a></li>
								
									<li class="nav-item "><a href="/cognitive-model/ddm/">Diffusion Decision Model</a></li>
								
									<li class="nav-item "><a href="/cognitive-model/cddm/">Circular Drift-diffusion Model</a></li>
								
									<li class="nav-item "><a href="/cognitive-model/pddm/">PDDM</a></li>
								
									<li class="nav-item current"><a href="/cognitive-model/lba3/">Three-accumulator LBA Model</a></li>
								
									<li class="nav-item "><a href="/cognitive-model/lca/">LCA Model</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/fixed-effect-model/one_participant/">Fixed-effects Model</a>
							<ul>
								
									<li class="nav-item "><a href="/fixed-effect-model/one_participant/">One Participant</a></li>
								
									<li class="nav-item "><a href="/fixed-effect-model/many_participants/">Multiple Participants</a></li>
								
									<li class="nav-item "><a href="/fixed-effect-model/cddm12S/">CDDM</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/mcmc/mcmc/">Modern Bayesian Statistics</a>
							<ul>
								
									<li class="nav-item "><a href="/mcmc/mcmc/">Markov Chain Monte Carlo</a></li>
								
									<li class="nav-item "><a href="/mcmc/rwm/">Random Walk Metropolis</a></li>
								
									<li class="nav-item "><a href="/mcmc/hastings/">Metropolis-Hastings</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/random-effect-model/hlba/">Hierarchical Model</a>
							<ul>
								
									<li class="nav-item "><a href="/random-effect-model/hlba/">HLBA Model</a></li>
								
									<li class="nav-item "><a href="/random-effect-model/hddm/">HDDM</a></li>
								
									<li class="nav-item "><a href="/random-effect-model/shooting-decision1/">Shooting Decision Model - Recovery Study</a></li>
								
									<li class="nav-item "><a href="/random-effect-model/shooting-decision2/">Shooting Decision Model - Empirical Data</a></li>
								
									<li class="nav-item "><a href="/random-effect-model/hcddm/">HCDDM</a></li>
								
									<li class="nav-item "><a href="/random-effect-model/hpm/">HPM Model</a></li>
								
							</ul>
						</li>
					
						<li class="nav-item top-level ">
							
							<a href="/sampling/genetic/">Sampling Techniques</a>
							<ul>
								
									<li class="nav-item "><a href="/sampling/genetic/">Population-based Monte Carlo</a></li>
								
									<li class="nav-item "><a href="/sampling/crossover/">Crossover</a></li>
								
									<li class="nav-item "><a href="/sampling/migration/">Migration</a></li>
								
									<li class="nav-item "><a href="/sampling/mutation/">Mutation</a></li>
								
									<li class="nav-item "><a href="/sampling/demc/">Differential Evolution Monte Carlo</a></li>
								
									<li class="nav-item "><a href="/sampling/demcmc/">Differential Evolution Markov Chain Monte Carlo</a></li>
								
									<li class="nav-item "><a href="/sampling/dgmc/">Distributed Genetic Monte Carlo</a></li>
								
							</ul>
						</li>
					
				</ul>

				<ul>
					<li class="nav-item top-level ">
						
						<a href="/changelog/">Change Log</a>
					</li>
				</ul>
			</nav>
		</header>

		<section class="main">
			<div class="page-header">
				<h2>Cognitive Model</h2>
				<h3>Three-accumulator LBA Model</h3>
			</div>
			<article class="content">
				<blockquote>
  <p>We have striven to minimize the number of errors. However, we canot 
guarantee the note is 100% accurate.</p>
</blockquote>

<p>This is a note for fitting 3-accumulator LBA model.</p>

<p>Some pre-analysis set up work.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">##</span> <span class="k">version</span> <span class="m">0.2.6.0</span>
<span class="p">##</span> <span class="n">install</span><span class="p">.</span><span class="n">packages</span><span class="p">(</span><span class="s2">"ggdmc"</span><span class="p">)</span>
<span class="n">loadedPackages</span> <span class="p">&lt;-</span><span class="n">c</span><span class="p">(</span><span class="s2">"ggdmc"</span><span class="p">,</span> <span class="s2">"data.table"</span><span class="p">,</span> <span class="s2">"ggplot2"</span><span class="p">,</span> <span class="s2">"gridExtra"</span><span class="p">,</span> <span class="s2">"ggthemes"</span><span class="p">)</span>
<span class="n">sapply</span><span class="p">(</span><span class="n">loadedPackages</span><span class="p">,</span> <span class="n">require</span><span class="p">,</span> <span class="n">character</span><span class="p">.</span><span class="n">only</span><span class="p">=</span><span class="nb">TRUE</span><span class="p">)</span>

<span class="p">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="n">HEAD</span>
<span class="p">##</span> <span class="n">A</span> <span class="k">function</span> <span class="n">for</span> <span class="n">generating</span> <span class="n">posterior</span> <span class="n">predict</span> <span class="n">fitples</span>
<span class="p">=======</span>
<span class="p">##</span> <span class="n">A</span> <span class="k">function</span> <span class="n">for</span> <span class="n">generating</span> <span class="n">posterior</span> <span class="n">predict</span> <span class="n">samples</span>
<span class="p">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="m">883650102262895</span><span class="n">c76c847a34bc17afd4f659a28</span>
<span class="n">predict_one</span> <span class="p">&lt;-</span> <span class="k">function</span><span class="p">(</span><span class="n">object</span><span class="p">,</span> <span class="n">npost</span> <span class="p">=</span> <span class="m">100</span><span class="p">,</span> <span class="n">rand</span> <span class="p">=</span> <span class="nb">TRUE</span><span class="p">,</span> <span class="n">factors</span> <span class="p">=</span> <span class="n">NA</span><span class="p">,</span>
                        <span class="n">xlim</span> <span class="p">=</span> <span class="n">NA</span><span class="p">,</span> <span class="n">seed</span> <span class="p">=</span> <span class="n">NULL</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">model</span> <span class="p">&lt;-</span> <span class="n">attributes</span><span class="p">(</span><span class="n">object</span><span class="p">$</span><span class="n">data</span><span class="p">)$</span><span class="k">model</span>
  <span class="n">facs</span> <span class="p">&lt;-</span> <span class="n">names</span><span class="p">(</span><span class="n">attr</span><span class="p">(</span><span class="k">model</span><span class="p">,</span> <span class="s2">"factors"</span><span class="p">))</span>
  <span class="n">class</span><span class="p">(</span><span class="n">object</span><span class="p">$</span><span class="n">data</span><span class="p">)</span> <span class="p">&lt;-</span> <span class="n">c</span><span class="p">(</span><span class="s2">"data.frame"</span><span class="p">,</span> <span class="s2">"list"</span><span class="p">)</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="c1">!is.null(factors))
</span>  <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">any</span><span class="p">(</span><span class="n">is</span><span class="p">.</span><span class="n">na</span><span class="p">(</span><span class="n">factors</span><span class="p">)))</span> <span class="n">factors</span> <span class="p">&lt;-</span> <span class="n">facs</span>
    <span class="k">if</span> <span class="p">(</span><span class="c1">!all(factors %in% facs))
</span>      <span class="nf">stop</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="s2">"Factors argument must contain one or more of:"</span><span class="p">,</span>
                 <span class="n">paste</span><span class="p">(</span><span class="n">facs</span><span class="p">,</span> <span class="n">collapse</span><span class="p">=</span><span class="s2">","</span><span class="p">)))</span>
  <span class="p">}</span>
  
  <span class="n">resp</span> <span class="p">&lt;-</span> <span class="n">names</span><span class="p">(</span><span class="n">attr</span><span class="p">(</span><span class="k">model</span><span class="p">,</span> <span class="s2">"responses"</span><span class="p">))</span>
  <span class="n">ns</span>   <span class="p">&lt;-</span> <span class="n">table</span><span class="p">(</span><span class="n">object</span><span class="p">$</span><span class="n">data</span><span class="p">[,</span><span class="n">facs</span><span class="p">],</span> <span class="n">dnn</span> <span class="p">=</span> <span class="n">facs</span><span class="p">)</span>
  <span class="n">npar</span>   <span class="p">&lt;-</span> <span class="n">object</span><span class="p">$</span><span class="n">n</span><span class="p">.</span><span class="n">pars</span>
  <span class="n">nchain</span> <span class="p">&lt;-</span> <span class="n">object</span><span class="p">$</span><span class="n">n</span><span class="p">.</span><span class="n">chains</span>
  <span class="n">nmc</span>    <span class="p">&lt;-</span> <span class="n">object</span><span class="p">$</span><span class="n">nmc</span>
<span class="p">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="n">HEAD</span>
  <span class="n">ntfitple</span> <span class="p">&lt;-</span> <span class="n">nchain</span> <span class="p">*</span> <span class="n">nmc</span>
<span class="p">=======</span>
  <span class="n">ntsample</span> <span class="p">&lt;-</span> <span class="n">nchain</span> <span class="p">*</span> <span class="n">nmc</span>
<span class="p">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="m">883650102262895</span><span class="n">c76c847a34bc17afd4f659a28</span>
  <span class="n">pnames</span>   <span class="p">&lt;-</span> <span class="n">object</span><span class="p">$</span><span class="n">p</span><span class="p">.</span><span class="n">names</span>
  
  <span class="n">thetas</span> <span class="p">&lt;-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">aperm</span><span class="p">(</span><span class="n">object</span><span class="p">$</span><span class="n">theta</span><span class="p">,</span> <span class="n">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">1</span><span class="p">)),</span> <span class="n">ncol</span> <span class="p">=</span> <span class="n">npar</span><span class="p">)</span>
  
  <span class="n">colnames</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span> <span class="p">&lt;-</span> <span class="n">pnames</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="n">is</span><span class="p">.</span><span class="n">na</span><span class="p">(</span><span class="n">npost</span><span class="p">))</span> <span class="p">{</span>
<span class="p">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="n">HEAD</span>
    <span class="n">use</span> <span class="p">&lt;-</span> <span class="m">1</span><span class="p">:</span><span class="n">ntfitple</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">rand</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">use</span> <span class="p">&lt;-</span> <span class="n">fitple</span><span class="p">(</span><span class="m">1</span><span class="p">:</span><span class="n">ntfitple</span><span class="p">,</span> <span class="n">npost</span><span class="p">,</span> <span class="n">replace</span> <span class="p">=</span> <span class="n">F</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">use</span> <span class="p">&lt;-</span> <span class="nb">round</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">ntfitple</span><span class="p">,</span> <span class="n">length</span><span class="p">.</span><span class="n">out</span> <span class="p">=</span> <span class="n">npost</span><span class="p">))</span>
<span class="p">=======</span>
    <span class="n">use</span> <span class="p">&lt;-</span> <span class="m">1</span><span class="p">:</span><span class="n">ntsample</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">rand</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">use</span> <span class="p">&lt;-</span> <span class="n">sample</span><span class="p">(</span><span class="m">1</span><span class="p">:</span><span class="n">ntsample</span><span class="p">,</span> <span class="n">npost</span><span class="p">,</span> <span class="n">replace</span> <span class="p">=</span> <span class="n">F</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="n">use</span> <span class="p">&lt;-</span> <span class="nb">round</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="n">ntsample</span><span class="p">,</span> <span class="n">length</span><span class="p">.</span><span class="n">out</span> <span class="p">=</span> <span class="n">npost</span><span class="p">))</span>
<span class="p">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="m">883650102262895</span><span class="n">c76c847a34bc17afd4f659a28</span>
    <span class="p">}</span>
  <span class="p">}</span>
  
  <span class="n">npost</span>  <span class="p">&lt;-</span> <span class="n">length</span><span class="p">(</span><span class="n">use</span><span class="p">)</span>
  <span class="n">posts</span>   <span class="p">&lt;-</span> <span class="n">thetas</span><span class="p">[</span><span class="n">use</span><span class="p">,</span> <span class="p">]</span>
  <span class="n">nttrial</span> <span class="p">&lt;-</span> <span class="k">sum</span><span class="p">(</span><span class="n">ns</span><span class="p">)</span> <span class="p">##</span> <span class="n">number</span> <span class="k">of</span> <span class="n">total</span> <span class="n">trials</span>
  
  <span class="n">v</span> <span class="p">&lt;-</span> <span class="n">lapply</span><span class="p">(</span><span class="m">1</span><span class="p">:</span><span class="n">npost</span><span class="p">,</span> <span class="k">function</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">ggdmc</span><span class="p">:::</span><span class="n">simulate_one</span><span class="p">(</span><span class="k">model</span><span class="p">,</span> <span class="n">n</span> <span class="p">=</span> <span class="n">ns</span><span class="p">,</span> <span class="n">ps</span> <span class="p">=</span> <span class="n">posts</span><span class="p">[</span><span class="n">i</span><span class="p">,],</span> <span class="n">seed</span> <span class="p">=</span> <span class="n">seed</span><span class="p">)</span>
  <span class="p">})</span>
  <span class="n">out</span> <span class="p">&lt;-</span> <span class="n">data</span><span class="p">.</span><span class="n">table</span><span class="p">::</span><span class="n">rbindlist</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
  
  <span class="n">reps</span> <span class="p">&lt;-</span> <span class="n">rep</span><span class="p">(</span><span class="m">1</span><span class="p">:</span><span class="n">npost</span><span class="p">,</span> <span class="n">each</span> <span class="p">=</span> <span class="n">nttrial</span><span class="p">)</span>
  <span class="n">out</span> <span class="p">&lt;-</span> <span class="n">cbind</span><span class="p">(</span><span class="n">reps</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
  
  <span class="k">if</span> <span class="p">(</span><span class="c1">!any(is.na(xlim)))
</span>  <span class="p">{</span>
    <span class="n">out</span> <span class="p">&lt;-</span> <span class="n">out</span><span class="p">[</span><span class="n">RT</span> <span class="p">&gt;</span> <span class="n">xlim</span><span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="p">&amp;</span> <span class="n">RT</span> <span class="p">&lt;</span> <span class="n">xlim</span><span class="p">[</span><span class="m">2</span><span class="p">]]</span>
  <span class="p">}</span>
  
  <span class="n">attr</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="s2">"data"</span><span class="p">)</span> <span class="p">&lt;-</span> <span class="n">object</span><span class="p">$</span><span class="n">data</span>
  <span class="n">return</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
  <span class="p">}</span>
  
</code></pre></div></div>

<p>In this example, we assumed three accumulators corresponding to three responses. 
Let’s say they are “Word”, “Nonword”, or “Pseudo-word”. They are coded 
respectively as W, N and P. This is to assume we had run some (visual) 
lexical-decision experiments, instructing participants to decide whether a 
stimulus is a word, a non-word, or a make-up word. The three types of stimuli 
are coded as ww, nn and pn.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">model</span> <span class="p">&lt;-</span> <span class="n">BuildModel</span><span class="p">(</span>
  <span class="n">p</span><span class="p">.</span><span class="n">map</span>     <span class="p">=</span> <span class="k">list</span><span class="p">(</span><span class="n">A</span> <span class="p">=</span> <span class="s2">"1"</span><span class="p">,</span> <span class="n">B</span> <span class="p">=</span> <span class="s2">"1"</span><span class="p">,</span> <span class="n">t0</span> <span class="p">=</span> <span class="s2">"1"</span><span class="p">,</span> <span class="n">mean_v</span> <span class="p">=</span> <span class="s2">"R"</span><span class="p">,</span> <span class="n">sd_v</span> <span class="p">=</span> <span class="s2">"1"</span><span class="p">,</span>
                   <span class="n">st0</span> <span class="p">=</span> <span class="s2">"1"</span><span class="p">),</span>
  <span class="n">match</span><span class="p">.</span><span class="n">map</span> <span class="p">=</span> <span class="k">list</span><span class="p">(</span><span class="n">M</span> <span class="p">=</span> <span class="k">list</span><span class="p">(</span><span class="n">ww</span> <span class="p">=</span> <span class="s2">"W"</span><span class="p">,</span> <span class="n">nn</span> <span class="p">=</span> <span class="s2">"N"</span><span class="p">,</span> <span class="n">pn</span> <span class="p">=</span> <span class="s2">"P"</span><span class="p">)),</span>
  <span class="n">factors</span>   <span class="p">=</span> <span class="k">list</span><span class="p">(</span><span class="n">S</span> <span class="p">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"ww"</span><span class="p">,</span> <span class="s2">"nn"</span><span class="p">,</span> <span class="s2">"pn"</span><span class="p">)),</span>
  <span class="n">constants</span> <span class="p">=</span> <span class="n">c</span><span class="p">(</span><span class="n">st0</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">sd_v</span> <span class="p">=</span> <span class="m">1</span><span class="p">),</span>
  <span class="n">responses</span> <span class="p">=</span> <span class="n">c</span><span class="p">(</span><span class="s2">"W"</span><span class="p">,</span> <span class="s2">"N"</span><span class="p">,</span> <span class="s2">"P"</span><span class="p">),</span>
  <span class="n">type</span>      <span class="p">=</span> <span class="s2">"norm"</span><span class="p">)</span>
<span class="p">##</span> <span class="n">Parameter</span> <span class="n">vector</span> <span class="n">names</span> <span class="n">are</span><span class="p">:</span> <span class="p">(</span> <span class="n">see</span> <span class="n">attr</span><span class="p">(,</span><span class="s2">"p.vector"</span><span class="p">)</span> <span class="p">)</span>
<span class="p">##</span> <span class="p">[</span><span class="m">1</span><span class="p">]</span> <span class="s2">"A"</span>        <span class="s2">"B"</span>        <span class="s2">"t0"</span>       <span class="s2">"mean_v.W"</span> <span class="s2">"mean_v.N"</span> <span class="s2">"mean_v.P"</span>
<span class="p">##</span> 
<span class="p">##</span> <span class="n">Constants</span> <span class="n">are</span> <span class="p">(</span><span class="n">see</span> <span class="n">attr</span><span class="p">(,</span><span class="s2">"constants"</span><span class="p">)</span> <span class="p">):</span>
<span class="p">##</span>  <span class="n">st0</span> <span class="n">sd_v</span> 
<span class="p">##</span>    <span class="m">0</span>    <span class="m">1</span> 
<span class="p">##</span> 
<span class="p">##</span> <span class="k">Model</span> <span class="n">type</span> <span class="p">=</span> <span class="n">norm</span> <span class="p">(</span><span class="n">posdrift</span> <span class="p">=</span> <span class="nb">TRUE</span> <span class="p">)</span> 
</code></pre></div></div>

<p>Firstly, as usual, we conducted a small recovery study. That is, we designated
a parameter vector with specific values and on the basis of this particular
parameter vector, we simulated a data set and fit such data set with the
model to see if it could recover the values reasonably well.</p>

<p>For now, we will show only the recovery study. We designated a true parameter
vector.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p.vector &lt;- c(A = 1.25, B = .25, t0 = .2, mean_v.W = 2.5, mean_v.N = 1.5,
              mean_v.P = 1.2)

## ggdmc adapts print function to help inspect model
print(model)

## The model array is huge
## W 
##         A    B   t0 mean_v.W mean_v.N mean_v.P sd_v  st0
## ww.W TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## nn.W TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## pn.W TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## ww.N TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## nn.N TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## pn.N TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## ww.P TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## nn.P TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## pn.P TRUE TRUE TRUE     TRUE    FALSE    FALSE TRUE TRUE
## N 
##         A    B   t0 mean_v.W mean_v.N mean_v.P sd_v  st0
## ww.W TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## nn.W TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## pn.W TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## ww.N TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## nn.N TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## pn.N TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## ww.P TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## nn.P TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## pn.P TRUE TRUE TRUE    FALSE     TRUE    FALSE TRUE TRUE
## P 
##         A    B   t0 mean_v.W mean_v.N mean_v.P sd_v  st0
## ww.W TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## nn.W TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## pn.W TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## ww.N TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## nn.N TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## pn.N TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## ww.P TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## nn.P TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## pn.P TRUE TRUE TRUE    FALSE    FALSE     TRUE TRUE TRUE
## The model object carries this many attributes
## Attributes: 
##  [1] "dim"        "dimnames"   "all.par"    "p.vector"   "par.names"  "type"       "factors"
##  [8] "responses"  "constants"  "posdrift"   "n1.order"   "match.cell" "match.map"  "is.r1"
## [15] "class"


print(model, p.vector)
## The following is how ggdmc allocates the parameters to each accumulator.
## [1] "ww.W"
##      A   b  t0 mean_v sd_v st0
## 1 1.25 1.5 0.2    2.5    1   0
## 2 1.25 1.5 0.2    1.5    1   0
## 3 1.25 1.5 0.2    1.2    1   0
## [1] "nn.W"
##      A   b  t0 mean_v sd_v st0
## 1 1.25 1.5 0.2    2.5    1   0
## 2 1.25 1.5 0.2    1.5    1   0
## 3 1.25 1.5 0.2    1.2    1   0
## [1] "pn.W"
##      A   b  t0 mean_v sd_v st0
## 1 1.25 1.5 0.2    2.5    1   0
## 2 1.25 1.5 0.2    1.5    1   0
## 3 1.25 1.5 0.2    1.2    1   0
...

## To see what other option in the simulate function
## ?ggdmc:::simulate.model
nsim &lt;- 2048
dat &lt;- simulate(model, nsim = nsim, ps = p.vector)
</code></pre></div></div>

<p>We used data.table to help inspect the data frame.  This makes no difference when
the data set is small. You are welcome to opt for dplyr/tibble or traditional
data.frame functions.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>d &lt;- data.table(dat)
dmi &lt;- BuildDMI(dat, model)

## Check the factor levels
sapply(d[, .(S,R)], levels)
##     S    R  
## [1,] "ww" "W"
## [2,] "nn" "N"
## [3,] "pn" "P"
</code></pre></div></div>

<p>To inspect the data distributions, we designated three response proportions, instead
of correct vs. error.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ww1 &lt;- d[S == "ww" &amp; R == "W" &amp; RT &lt;= 10, "RT"]
ww1 &lt;- d[S == "ww" &amp; R == "W" &amp; RT &lt;= 10, "RT"]
ww2 &lt;- d[S == "ww" &amp; R == "N" &amp; RT &lt;= 10, "RT"]
ww3 &lt;- d[S == "ww" &amp; R == "P" &amp; RT &lt;= 10, "RT"]
nn1 &lt;- d[S == "nn" &amp; R == "W" &amp; RT &lt;= 10, "RT"]
nn2 &lt;- d[S == "nn" &amp; R == "N" &amp; RT &lt;= 10, "RT"]
nn3 &lt;- d[S == "nn" &amp; R == "P" &amp; RT &lt;= 10, "RT"]
pn1 &lt;- d[S == "pn" &amp; R == "W" &amp; RT &lt;= 10, "RT"]
pn2 &lt;- d[S == "pn" &amp; R == "N" &amp; RT &lt;= 10, "RT"]
pn3 &lt;- d[S == "pn" &amp; R == "P" &amp; RT &lt;= 10, "RT"]

xlim &lt;- c(0, 5)
par(mfrow=c(1, 3), mar = c(4, 4, 0.82, 1))
hist(ww1$RT, breaks = "fd", freq = TRUE, xlim = xlim, main='Word', xlab='RT(s)',
     cex.lab=1.5)
hist(ww2$RT, breaks = "fd", freq = TRUE, add = TRUE, col = "lightblue")
hist(ww3$RT, breaks = "fd", freq = TRUE, add = TRUE, col = "orange")

hist(nn1$RT, breaks = "fd", freq = TRUE, xlim = xlim, main='Non-word', 
     xlab='RT(s)', ylab='', cex.lab=1.5)
hist(nn2$RT, breaks = "fd", freq = TRUE, add = TRUE, col = "lightblue")
hist(nn3$RT, breaks = "fd", freq = TRUE, add = TRUE, col = "orange")

hist(pn1$RT, breaks = "fd", freq = TRUE, xlim = xlim, main='P-word', 
     xlab='RT(s)', ylab='', cex.lab=1.5)
hist(pn2$RT, breaks = "fd", freq = TRUE, add = TRUE, col = "lightblue")
hist(pn3$RT, breaks = "fd", freq = TRUE, add = TRUE, col = "orange")
par(mfrow=c(1, 1))
</code></pre></div></div>

<h2 id="prior-distribution">Prior distribution</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>p.prior &lt;- BuildPrior(
  dists = c("tnorm", "tnorm", "beta", "tnorm", "tnorm", "tnorm"),
  p1    = c(A = .3, B = 1, t0 = 1,
            mean_v.W = 1, mean_v.N = 0, mean_v.P = .1),
  p2    = c(1, 1,   1,  3, 3, 3),
  lower = c(0, 0,   0, NA, NA, NA),
  upper = c(NA, NA, 1, NA, NA, NA))

## Visually check the prior distributions
plot(p.prior)
</code></pre></div></div>

<h2 id="sampling">Sampling</h2>

<p>«««&lt; HEAD
The default iteration is 200 for StartNewfitples function.</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fit0 &lt;- StartNewfitples(dmi, p.prior)
=======
The default iteration is 200 for StartNewsamples function. 
</code></pre></div></div>
<p>fit0 &lt;- StartNewsamples(dmi, p.prior)</p>
<blockquote>
  <blockquote>
    <blockquote>
      <blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <p>883650102262895c76c847a34bc17afd4f659a28</p>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote>
    </blockquote>
  </blockquote>
</blockquote>

<h2 id="about-301-s">About 301 s</h2>
<p>fit &lt;- run(fit0)</p>

<h2 id="diagnosis-checks">Diagnosis checks</h2>
<p>gelman(fit)</p>
<h1 id="potential-scale-reduction-factors">Potential scale reduction factors:</h1>
<p>#</p>
<h1 id="point-est-upper-ci">Point est. Upper C.I.</h1>
<h1 id="a--------------155-------180">A              1.55       1.80</h1>
<h1 id="b--------------171-------201">B              1.71       2.01</h1>
<h1 id="t0-------------180-------224">t0             1.80       2.24</h1>
<h1 id="mean_vw-------157-------182">mean_v.W       1.57       1.82</h1>
<h1 id="mean_vn-------147-------169">mean_v.N       1.47       1.69</h1>
<h1 id="mean_vp-------141-------160">mean_v.P       1.41       1.60</h1>
<p>#</p>
<h1 id="multivariate-psrf">Multivariate psrf</h1>
<p>#</p>
<h1 id="198">1.98</h1>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
The PSRF suggests that the chains have yet converged to a stable parameter space.

</code></pre></div></div>
<p>plot(fit)</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
The trace plot of posterior log-likelihood suggests the chains almost approach the parameter
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
space, so we discard all previous fitples as burn-in. That is, we did not turn on the _add_
switch. The fitpler reaches the parameter space fast.  It took about
700 iterations. Note this is a model with 6 parameters and some of them 
(A and B) are correlated. 

We ran another 500 (default) iterations and took a fitple every 8 iteration.
=======
space, so we discard all previous samples as burn-in. That is, we did not turn on the _add_
switch. The sampler reaches the parameter space fast.  It took about
700 iterations. Note this is a model with 6 parameters and some of them 
(A and B) are correlated. 

We ran another 500 (default) iterations and took a sample every 8 iteration.
&gt;&gt;&gt;&gt;&gt;&gt;&gt; 883650102262895c76c847a34bc17afd4f659a28

</code></pre></div></div>
<h2 id="run-to-see-add-and-other-options-in-run-function">?run to see add and other options in run function</h2>
<h2 id="watch-out-this-would-take-a-while--1-hr-or-more-depending-on-your-cpu">Watch out! This would take a while (~ 1 hr or more depending on your CPU)</h2>
<p>fit &lt;- run(fit, thin=8)</p>

<h2 id="the-three-follow-up-checks-show-the-chains-are-converged-and-we-have-drawn">The three follow-up checks show the chains are converged and we have drawn</h2>
<p>«««&lt; HEAD</p>
<h2 id="sufficient-size-of-fitples">sufficient size of fitples.</h2>
<p>=======</p>
<h2 id="sufficient-size-of-samples">sufficient size of samples.</h2>
<blockquote>
  <blockquote>
    <blockquote>
      <blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <p>883650102262895c76c847a34bc17afd4f659a28
plot(fit)</p>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote>
    </blockquote>
  </blockquote>
</blockquote>

<p>es &lt;- effectiveSize(fit)</p>
<h2 id="a--------b-------t0-mean_vw-mean_vn-mean_vp">A        B       t0 mean_v.W mean_v.N mean_v.P</h2>
<h2 id="3032669-3160306-3264266-2998928-2979326-3022245">3032.669 3160.306 3264.266 2998.928 2979.326 3022.245</h2>

<p>gelman(fit)</p>
<h1 id="potential-scale-reduction-factors-1">Potential scale reduction factors:</h1>
<p>#</p>
<h1 id="point-est-upper-ci-1">Point est. Upper C.I.</h1>
<h1 id="a-----------------1-------100">A                 1       1.00</h1>
<h1 id="b-----------------1-------100">B                 1       1.00</h1>
<h1 id="t0----------------1-------101">t0                1       1.01</h1>
<h1 id="mean_vw----------1-------100">mean_v.W          1       1.00</h1>
<h1 id="mean_vn----------1-------100">mean_v.N          1       1.00</h1>
<h1 id="mean_vp----------1-------100">mean_v.P          1       1.00</h1>
<p>#</p>
<h1 id="multivariate-psrf-1">Multivariate psrf</h1>
<p>#</p>
<h1 id="1">1</h1>

<p>est &lt;- summary(fit, ps = p.vector, verbose = TRUE, recovery = TRUE)</p>
<h1 id="a----b-mean_vn-mean_vp-mean_vw---t0">A    B mean_v.N mean_v.P mean_v.W   t0</h1>
<h1 id="true-----------125-025-----150-----120-----250-020">True           1.25 0.25     1.50     1.20     2.50 0.20</h1>
<h1 id="25-estimate--119-023-----146-----115-----239-019">2.5% Estimate  1.19 0.23     1.46     1.15     2.39 0.19</h1>
<h1 id="50-estimate---131-026-----164-----133-----259-020">50% Estimate   1.31 0.26     1.64     1.33     2.59 0.20</h1>
<h1 id="975-estimate-145-030-----183-----152-----280-021">97.5% Estimate 1.45 0.30     1.83     1.52     2.80 0.21</h1>
<h1 id="median-true----006-001-----014-----013-----009-000">Median-True    0.06 0.01     0.14     0.13     0.09 0.00</h1>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

The posterior prediction check takes up a lot of manually coding work. Anyway,
the figure show the data and posterior predictions are consistent, confirming
the model can successfully recover the data (at least in an ideal simulation
scenario).

</code></pre></div></div>
<p>pp &lt;- predict_one(fit, xlim = c(0, 5))</p>

<p>original_data &lt;- fit1$data
dplyr::tbl_df(original_data)
d &lt;- data.table(original_data)</p>

<h2 id="response-proportions">Response proportions</h2>
<p>d[, .N, .(S)]
d[, .N/100, .(S, R)]</p>

<h2 id="score-for-the-correct-and-error-response">Score for the correct and error response</h2>
<p>dat$C &lt;- ifelse(dat$S == “ww” &amp; dat$R == “W”, “O”,
         ifelse(dat$S == “nn” &amp; dat$R == “N”, “O”,
         ifelse(dat$S == “pn” &amp; dat$R == “P”, “O”,
         ifelse(dat$S == “ww” &amp; dat$R == “N”, “X”,
         ifelse(dat$S == “ww” &amp; dat$R == “P”, “X”,
         ifelse(dat$S == “nn” &amp; dat$R == “W”, “X”,
         ifelse(dat$S == “nn” &amp; dat$R == “P”, “X”,
         ifelse(dat$S == “pn” &amp; dat$R == “N”, “X”,
         ifelse(dat$S == “pn” &amp; dat$R == “W”, “X”, NA)))))))))</p>

<p>pp$C &lt;- ifelse(pp$S == “ww” &amp; pp$R == “W”, “O”,
        ifelse(pp$S == “nn” &amp; pp$R == “N”, “O”,
        ifelse(pp$S == “pn” &amp; pp$R == “P”, “O”,
        ifelse(pp$S == “ww” &amp; pp$R == “N”, “X”,
        ifelse(pp$S == “ww” &amp; pp$R == “P”, “X”,
        ifelse(pp$S == “nn” &amp; pp$R == “W”, “X”,
        ifelse(pp$S == “nn” &amp; pp$R == “P”, “X”,
        ifelse(pp$S == “pn” &amp; pp$R == “N”, “X”,
        ifelse(pp$S == “pn” &amp; pp$R == “W”, “X”, NA)))))))))</p>

<p>dat0 &lt;- dat
dat0$reps &lt;- NA
dat0$type &lt;- “Data”
pp$reps &lt;- factor(pp$reps)
pp$type &lt;- “Simulation”
combined_data &lt;- rbind(dat0, pp)</p>

<p>dplyr::tbl_df(combined_data)</p>

<p>p1 &lt;- ggplot(combined_data, aes(RT, color = reps, size = type)) +
  geom_freqpoly(binwidth = .10) +
  scale_size_manual(values = c(1, .3)) +
  scale_color_grey(na.value = “black”) +
  ylab(“Count”) +
  facet_grid(S ~ C) +
  theme_bw(base_size = 16) +
  theme(strip.background = element_blank(),
        legend.position=”none”)</p>

<p>print(p1)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
## How to fix array dimension inconsistency
If data were stored by a previous version of ggdmc or by DMC, their arraies
are arranged differently as noted [here](https://github.com/yxlin/ggdmc). The 
following is one convenient way to transpose them.

</code></pre></div></div>
<h2 id="first-make-sure-they-are-indeed-needed-to-be-transposed">First make sure they are indeed needed to be transposed</h2>
<p>«««&lt; HEAD
dim(fit0$theta)
dim(fit0$summed_log_prior)
dim(fit0$log_likelihoods)</p>

<h2 id="use-aperm-and-t-to-transpose-arraies-and-matrices">Use aperm and t to transpose arraies and matrices</h2>
<p>fit0$theta &lt;- aperm(fit0$theta, c(2, 1, 3))
fit0$summed_log_prior &lt;- t(fit0$summed_log_prior)
fit0$log_likelihoods &lt;- t(fit0$log_likelihoods)</p>

<p>fit$theta &lt;- aperm(fit$theta, c(2, 1, 3))
fit$summed_log_prior &lt;- t(fit$summed_log_prior)
fit$log_likelihoods &lt;- t(fit$log_likelihoods)</p>

<h2 id="attach-the-model-class-to-the-fitples">Attach the model class to the fitples.</h2>
<p>=======
dim(sam0$theta)
dim(sam0$summed_log_prior)
dim(sam0$log_likelihoods)</p>

<h2 id="use-aperm-and-t-to-transpose-arraies-and-matrices-1">Use aperm and t to transpose arraies and matrices</h2>
<p>sam0$theta &lt;- aperm(sam0$theta, c(2, 1, 3))
sam0$summed_log_prior &lt;- t(sam0$summed_log_prior)
sam0$log_likelihoods &lt;- t(sam0$log_likelihoods)</p>

<p>sam$theta &lt;- aperm(sam$theta, c(2, 1, 3))
sam$summed_log_prior &lt;- t(sam$summed_log_prior)
sam$log_likelihoods &lt;- t(sam$log_likelihoods)</p>

<h2 id="attach-the-model-class-to-the-samples">Attach the model class to the samples.</h2>
<blockquote>
  <blockquote>
    <blockquote>
      <blockquote>
        <blockquote>
          <blockquote>
            <blockquote>
              <p>883650102262895c76c847a34bc17afd4f659a28
class(fit0) &lt;- c(“list”, “model”)
class(fit) &lt;- c(“list”, “model”)</p>
            </blockquote>
          </blockquote>
        </blockquote>
      </blockquote>
    </blockquote>
  </blockquote>
</blockquote>

<p>```</p>

			</article>
		</section>

		<script>
			document.getElementById("open-nav").addEventListener("click", function () {
				document.body.classList.toggle("nav-open");
			});

			
		</script>

		  
		</script>
	</body>
</html>
